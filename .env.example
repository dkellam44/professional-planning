# ============================================================================
# ENVIRONMENT CONFIGURATION TEMPLATE - Portfolio Service Infrastructure
# ============================================================================
# ⚠️  THIS IS AN EXAMPLE FILE - Copy to .env for local development
# DO NOT include real secrets in this file - it will be committed to git
# Use placeholder values and update your local .env with real secrets
# ============================================================================

# ============================================================================
# SECTION 1: RUNTIME & NODE.JS CONFIGURATION
# ============================================================================
NODE_ENV=development
MCP_SERVER_PORT=8080
PORT=3000
APP_BASE_URL=http://localhost:3000

# ============================================================================
# SECTION 2: STYTCH OAUTH 2.1 AUTHENTICATION (Phase 2 - NEW)
# ============================================================================
# Stytch is the OAuth 2.1 provider for ChatGPT/Claude.ai web integration
# Setup Instructions:
# 1. Create Stytch account at https://stytch.com
# 2. Create new project in dashboard
# 3. Copy Project ID and API Secret to .env
#
# Phase 2 Tasks: service-builds/mcp-servers/coda/
# - Implement stytch-auth.ts middleware
# - Add OAuth metadata endpoints (RFC 8414, 9728)
# - Update docker-compose.yml with Stytch env vars
STYTCH_PROJECT_ID=replace_with_your_project_id
STYTCH_SECRET=replace_with_your_api_secret

# ============================================================================
# SECTION 3: CODA API INTEGRATION (Service Token)
# ============================================================================
# Service-to-service token for MCP to access Coda API
# Generate at: https://coda.io/account/settings#api
#
# Phase 1: Stored in environment variable
# Phase 3: Will move to PostgreSQL with AES-256-GCM encryption
# Phase 4: Will move to Infisical secrets manager
CODA_API_TOKEN=replace_with_your_coda_api_token

# ============================================================================
# SECTION 4: CLOUDFLARE INTEGRATION (Phase 1 - Legacy, deprecate Phase 2F)
# ============================================================================
# Currently provides zero-IP tunnel and JWT authentication
# Phase 2: Will be replaced with Stytch OAuth 2.1
# Phase 2F: Bearer token fallback remains for Claude Code development
#
# Get from: https://dash.cloudflare.com/
CLOUDFLARE_API_TOKEN=replace_with_your_api_token
CLOUDFLARE_ACCOUNT_ID=replace_with_your_account_id
CLOUDFLARE_TUNNEL_TOKEN=replace_with_your_tunnel_token

# ============================================================================
# SECTION 5: AUTHENTICATION & SECURITY
# ============================================================================
# Session & JWT secrets for general application authentication
SESSION_SECRET=replace_with_secure_random_string
JWT_SECRET=replace_with_secure_random_string

# Bearer token fallback for Claude Code development (Phase 2 transition)
BEARER_TOKEN=replace_with_bearer_token

# Encryption key for service token storage (Phase 3)
# Generate with: openssl rand -hex 32
MCP_AUTH_ENCRYPTION_KEY=replace_with_32_byte_hex_string

# ============================================================================
# SECTION 6: POSTGRESQL DATABASE (Infrastructure)
# ============================================================================
# Database for n8n, qdrant metadata, and future service token storage (Phase 3)
#
# Phase 3: Will add tokens table with AES-256-GCM encryption
# Phase 4: Migration path to Infisical for centralized secrets
POSTGRES_HOST=postgres
POSTGRES_PORT=5432
POSTGRES_USER=postgres
POSTGRES_PASSWORD=replace_with_postgres_password
POSTGRES_DB=portfolio_db
PGSSLMODE=disable
POSTGRES_MIN_CONNECTIONS=2
POSTGRES_MAX_CONNECTIONS=10
DATABASE_URL=postgres://postgres:replace_with_password@postgres:5432/portfolio_db

# ============================================================================
# SECTION 7: N8N WORKFLOW AUTOMATION (Droplet Service)
# ============================================================================
# n8n deployed on droplet for workflow automation
# Dashboard: https://n8n.bestviable.com
N8N_HOST=n8n
N8N_PORT=5678
N8N_ENCRYPTION_KEY=replace_with_n8n_encryption_key
N8N_USER_MANAGEMENT_JWT_SECRET=replace_with_n8n_jwt_secret
N8N_DB_URL=postgres://postgres:replace_with_password@postgres:5432/n8n_db
N8N_API_KEY=replace_with_n8n_api_key

# ============================================================================
# SECTION 8: QDRANT VECTOR DATABASE (Droplet Service)
# ============================================================================
# Qdrant for vector embeddings and semantic search
QDRANT_HOST=qdrant
QDRANT_PORT=6333
QDRANT_GRPC_PORT=6334
QDRANT_API_KEY=replace_with_qdrant_api_key

# ============================================================================
# SECTION 9: REDIS CACHE (Optional)
# ============================================================================
# Redis for caching and session management
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_PASSWORD=replace_with_redis_password
REDIS_DB=0
REDIS_URL=redis://default:replace_with_password@redis:6379/0

# ============================================================================
# SECTION 10: OPENWEBUI (Droplet Service)
# ============================================================================
# OpenWebUI for LLM interface and model management
OPENWEBUI_HOST=openweb
OPENWEBUI_PORT=3000
OPENWEBUI_ADMIN_EMAIL=admin@example.com
OPENWEBUI_ADMIN_PASSWORD=replace_with_password

# ============================================================================
# SECTION 11: TRAEFIK REVERSE PROXY (Droplet Service)
# ============================================================================
# Traefik v3.0 for routing to all services
# Dashboard: https://traefik.bestviable.com
TRAEFIK_DASHBOARD_USER=admin
TRAEFIK_DASHBOARD_PASSWORD=replace_with_password
TRAEFIK_ACME_EMAIL=admin@bestviable.com

# ============================================================================
# SECTION 12: SERVICE DOMAIN CONFIGURATION
# ============================================================================
MCP_DOMAIN=coda.bestviable.com
API_DOMAIN=api.bestviable.com
WEB_DOMAIN=bestviable.com

# ============================================================================
# SECTION 13: TOKEN STORAGE STRATEGY
# ============================================================================
# Controls where service tokens (Coda API token) are stored
# Options: env | postgres | infisical
# Phase 1 (current):  env        - CODA_API_TOKEN environment variable
# Phase 3 (planned):  postgres   - Encrypted in PostgreSQL
# Phase 4 (planned):  infisical  - Infisical secrets manager
TOKEN_STORE=env

# ============================================================================
# SECTION 14: INFISICAL SECRETS MANAGER (Phase 4 - Centralized Secrets)
# ============================================================================
# Infisical for managing secrets across infrastructure
# Phase 4: Will replace environment-based secrets
INFISICAL_HOST=infisical.bestviable.com
INFISICAL_API_KEY=replace_with_api_key
INFISICAL_WORKSPACE_ID=replace_with_workspace_id
INFISICAL_TOKEN=replace_with_service_token

# ============================================================================
# SECTION 15: LLM / AI PROVIDERS (For development & testing)
# ============================================================================
OPENAI_API_KEY=replace_with_openai_key
ANTHROPIC_API_KEY=replace_with_anthropic_key
GOOGLE_API_KEY=replace_with_google_key
OPENROUTER_API_KEY=replace_with_openrouter_key
LLM_PROVIDER=anthropic

# ============================================================================
# SECTION 16: OBJECT STORAGE (AWS S3 Compatible - Optional)
# ============================================================================
AWS_ACCESS_KEY_ID=replace_with_access_key
AWS_SECRET_ACCESS_KEY=replace_with_secret_key
AWS_REGION=us-east-1
AWS_S3_ENDPOINT=https://nyc3.digitaloceanspaces.com
S3_BUCKET_NAME=replace_with_bucket_name

# ============================================================================
# SECTION 17: EMAIL CONFIGURATION (Optional - SMTP)
# ============================================================================
SMTP_HOST=smtp.example.com
SMTP_PORT=587
SMTP_USER=replace_with_email
SMTP_PASS=replace_with_password
SMTP_SECURE=false

# ============================================================================
# SECTION 18: SSH AGENT & DEPLOYMENT
# ============================================================================
SSH_AGENT_DO=tools-droplet-agents
DO_API_TOKEN=replace_with_digitalocean_token

# ============================================================================
# SECTION 19: LOGGING & DEBUGGING
# ============================================================================
LOG_LEVEL=info
DEBUG=false
MCP_DEBUG=false
SENTRY_DSN=replace_with_sentry_dsn

# ============================================================================
# SECTION 20: FEATURE FLAGS & OPTIONAL SETTINGS
# ============================================================================
FEATURE_FLAGS=stytch-oauth
WATCH_MODE=false
TYPESCRIPT_WATCH=false
