flowchart TD
  subgraph Planning[Planning Stream]
    P1[Planning Brief]
    P2[Comparables]
    P3[Open Questions]
  end

  subgraph Execution[Execution Stream]
    E1[Canonical Facts]
    E2[Constraints]
    E3[Current Status]
  end

  subgraph Review[Review/Debug Stream]
    R1[Decision Log]
    R2[Attempts & Diffs]
  end

  SO[(Source-of-Truth Library)]
  SHO{{Session Handoff Object}}
  RETRIEVER[[Hybrid Retrieval + Rerank]]
  EVAL[[DSPy + RAGAS/DeepEval]]
  MCP[(MCP Tool Adapters)]
  CC[Claude Code CLI]

  SO --> RETRIEVER
  Planning --> RETRIEVER
  Execution --> RETRIEVER
  Review --> RETRIEVER
  RETRIEVER --> SHO
  SHO --> CC
  CC --> Review
  SO --> EVAL
  RETRIEVER --> EVAL
  MCP --> Planning
  MCP --> Execution
